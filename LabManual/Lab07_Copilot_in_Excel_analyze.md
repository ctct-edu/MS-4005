# 演習：Microsoft 365 Copilot in Excel を使用してテーブルを分析および操作する

## 演習概要

新しい列に対する数式の書き方が分からない場合、Microsoft 365 Copilot in Excel はデータに基づいて数式を含む新しい列を素早く追加できます。データをテーブル形式にフォーマットして、Copilot の機能を最大限に活用しましょう。

この演習では、Excel の Copilot を使用してテーブルデータを効果的に分析し、数式列を追加して洞察を得る方法を学習します。

### 事前準備：ファイルのOneDriveへのコピー

1. **SharePointサイトへのアクセス**：Microsoft 365のアプリ一覧から「SharePoint」を選択し、**ms-4005**サイトにアクセスします。

2. **ファイルの確認**：サイト内のドキュメントライブラリで「**Fabrikam Q1 marketing campaigns.xlsx**」を見つけます。

3. **ファイルのコピー**：
   - ファイル名の右側にある「**...**」（その他のオプション）をクリック
   - メニューから「**コピー**」を選択
   - 表示されるダイアログのコピー先（メニュー左側）から、「**マイファイル**」を選択
   - 「**ここにコピー**」をクリック

4. **OneDriveでの確認**：
   - Microsoft 365のアプリ一覧から「OneDrive」を選択
   - メニューからマイファイルを選択し、コピーしたファイルが正しく保存されていることを確認

### Excel でのファイル オープンと Copilot 起動
5. マイファイルページで、ファイル一覧から「**Mystic Spice Premium Chai Market Analysis Presentation.pptx**」を選択します。
6. ファイルがPower Pointで開いたら、リボンの「ホーム」タブにある **Copilot** アイコンをクリックして、Copilot パネルを開きます。

## Excel でのテーブル作業の基本

### Copilot を使用した数式列の追加方法

1. **データのテーブル形式確認**：
   - データがテーブル形式でフォーマットされていることを確認します

2. **数式列追加の開始**：
   - リボンで「**Copilot**」ボタンを選択します
   - 「**数式列を提案する**」または「**数式列の提案を表示**」を選択します
   - または、独自の言葉で追加したい列について記述します

3. **数式の説明確認**：
   - Copilot は数式の提案とその動作原理の説明を提供します
   - 数式ウィンドウの「**説明の表示**」を展開して、説明を確認します

4. **列の挿入**：
   - 「**+ 列を挿入**」を選択して数式列をテーブルに追加します

**重要**：AI が生成したコンテンツと同様に、Copilot が作成したものは必ず確認、編集、検証することが重要です。

## 演習手順

### 1. プロンプトの構成要素を理解する

#### プロンプトの構成要素

効果的な数式列作成プロンプトには以下の4つの要素が含まれます：

| 要素 | 説明 | 例 |
|------|------|-----|
| **目標 (Goal)** | 何をしたいかを明確にする | 数式列を提案してください |
| **コンテキスト (Context)** | 数式が何を計算すべきかを説明する | 各キャンペーンのエンゲージメント比率を決定するために列Jに |
| **ソース (Source)** | 計算に必要な特定の列を指定する | '関心度の高いユーザー' と '対象ユーザーの合計数' の値を使用して |
| **期待値 (Expectations)** | 数式の構造を正しく設定する | '関心度の高いユーザー' を '対象ユーザーの合計数' で割り、結果をパーセンテージ形式で表示してください |

### 2. 基本的な数式列の提案

#### 基本プロンプトの実行

1. Copilot パネルで以下のプロンプトを入力します：
   ```
   数式列を提案してください。
   ```

2. 結果を確認し、どのような数式が提案されるかを観察します。

### 3. 改良されたプロンプトでの数式作成

#### コンテキストを追加したプロンプト

3. 以下のプロンプトを試します：
   ```
   各キャンペーンのエンゲージメント比率を決定するために列Jの数式を提案してください。
   ```

4. 結果を確認し、基本プロンプトとの違いを比較します。
 - 注) この時点で正しく出力される場合もあります。

#### ソースを指定したプロンプト

5. 以下のプロンプトを試します：
   ```
   各キャンペーンのエンゲージメント比率を決定するために列Jの数式を提案してください。'関心度の高いユーザー' と '対象ユーザーの合計数' の値を使用してください。
   ```

6. 特定の列を参照したより正確な数式が提案されることを確認します。

#### 期待値を明確にしたプロンプト

7. 以下の完成されたプロンプトを試します：
   ```
   各キャンペーンのエンゲージメント比率を計算する列Jの数式を提案してください。'関心度の高いユーザー' と '対象ユーザーの合計数' の値を使用してください。数式は '関心度の高いユーザー' を '対象ユーザーの合計数' で割り、結果をパーセンテージ形式で表示するようにしてください。
   ```

8. 結果を確認し、期待通りの数式が生成されることを確認します。



## 完了

以上で Microsoft 365 Copilot in Excel を使用してテーブルを分析および操作するの演習は完了です。
